clc;
clear;
%%%%%%%%%%%%%计算BRG
% % % %%CDC Paper Fig. 7 Example
% Post=[0 1 0 0;1 0 0 0;0 0 0 0;0 0 0 0];
% Pre=[1 0 0 1;0 1 1 0;0 0 1 0;0 0 0 1];
% M0=[3 1 1 1]';
% Te=[1 2 3 4];
% % % nu=0;
% %Te=[1];
% % % nu=2;


%***********New Example 0218*******************
% Post=[0 0 1 0 0 0;1 0 0 0 0 0;0 1 0 0 0 0;0 0 0 0 0 0;0 0 0 0 0 0;0 0 0 0 0 0];
% Pre=[1 0 0 1 0 0;0 1 0 0 1 0;0 0 1 0 0 1;0 0 0 1 0 0;0 0 0 0 1 0;0 0 0 0 0 1];
% M0=[2 0 0 1 1 1]';
% Te=[3 4 5 6];
% nu=5;

% %%%%%%%%%%CDC Paper Fig. 4 Example
% Post=[0 0 0 1 1;1 0 0 0 0;0 1 0 0 0;0 0 1 0 0];
% Pre=[1 0 0 0 0;0 1 0 0 0;0 0 1 1 0;0 0 0 0 1];
% M0=[1 1 0 0]';
% Te=[4 5];
% nu=2;

% %%%%%%%%%%CDC Paper Fig. 7 Example (Cabasino, 参数(2, 1))
% Post=[0 0 0 0 0 0 0 0 0 1 1 1 1 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0; 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1];
% Pre=[4 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0; 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1; 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0];
% M0=[4 0 0 0 0 0 0 0 0 0 0 0 0]';
% Te=[1];
% % nu=0;

% % %%%%%%%%%CDC Paper Fig. 7 Example (Cabasino, 参数(2, 2))
% Post=[0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0; 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1];
% Pre=[4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0];
% M0=[4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]'; 
% Te=[1 14];
% nu=17;

% %%%%%%%%%%CDC Paper Fig. 7 Example (Cabasino, 参数(2, 3))
% Post=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1];
% Pre=[4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1; 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0];
% M0=[4 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]'; 
% Te=[1 18];
% nu=21;
% %*************************************************************
% Pre=[1 0 0;0 1 2;0 0 1];
% Post=[0 1 0;1 0 0;0 0 0];
% M0=[2 0 1]';
% Te=[1];
% nu=2;
%************************************************************
% Pre = [
% 6 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
% 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
% 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
% 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0;
% 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0;
% 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0;
% 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0;
% 0 0 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0;
% 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1 0 0;
% 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0;
% 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 0;
% 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1;
% 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0
% ];
% Post = [
% 0 0 0 0 0 0 0 1 1 1 1 1 1 0 0 0 0;
% 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
% 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
% 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
% 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
% 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
% 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
% 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
% 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0;
% 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0;
% 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0;
% 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0;
% 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1
% ];
% M0 = [6 0 0 0 0 0 0 0 0 0 0 0 0]';
% Te=[1 8];




%%%%%%%%%Liu Gaiyun Paper Example
% Post=[1 0 0 0 0 0 0 0 0;0 1 0 0 0 0 0 0 0;0 0 0 1 0 0 0 0 0;0 0 0 0 1 0 0 0 0;0 0 0 0 0 0 1 0 0;0 0 0 0 0 0 0 1 0;0 1 0 0 2 0 0 0 2;0 0 1 0 0 2 0 2 0;0 0 1 0 0 0 0 0 0;0 0 0 0 0 1 0 0 0;0 0 0 0 0 0 0 0 1];
% Pre=[0 1 0 0 0 0 0 0 0;0 0 1 0 0 0 0 0 0;0 0 0 0 1 0 0 0 0;0 0 0 0 0 1 0 0 0;0 0 0 0 0 0 0 1 0;0 0 0 0 0 0 0 0 1;1 0 0 2 0 0 0 2 0;0 1 0 0 2 0 2 0 0;1 0 0 0 0 0 0 0 0;0 0 0 1 0 0 0 0 0;0 0 0 0 0 0 1 0 0];
% M0=[0 0 0 0 0 0 3 3 6 6 6]';
% %M0=[0 0 0 0 0 0 12 13 25 25 25]';
% Te=[2 5 8];
% nu=6;
% Te=[1 2 3 4 5 6 7 8 9];
% nu=0;

% % %%%%%%%%%%Liu Gaiyun Paper Example (Ordinary version P=17, T=13)
Pre = [
0,1,0,0,0,0,0,0,0,0,0,0,0;
0,0,1,0,0,0,0,0,0,0,0,0,0;
0,0,0,1,0,0,0,0,0,0,0,0,0;
0,0,0,0,1,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,1,0,0,0,0,0,0;
0,0,0,0,0,0,0,1,0,0,0,0,0;
0,0,0,0,0,0,0,0,1,0,0,0,0;
0,0,0,0,0,0,0,0,0,1,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,1,0;
0,0,0,0,0,0,0,0,0,0,0,0,1;
0,1,0,0,0,0,1,0,0,0,0,1,0;
0,0,1,0,0,0,0,1,0,0,1,0,0;
1,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,1,0,0,0,0,0,0,0,0,0,0;
1,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,1,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,1,0,0;
];
Post = [
1,0,0,0,0,0,0,0,0,0,0,0,0;
0,1,0,0,0,0,0,0,0,0,0,0,0;
0,0,1,0,0,0,0,0,0,0,0,0,0;
0,0,0,1,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,1,0,0,0,0,0,0,0;
0,0,0,0,0,0,1,0,0,0,0,0,0;
0,0,0,0,0,0,0,1,0,0,0,0,0;
0,0,0,0,0,0,0,0,1,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,1,0,0;
0,0,0,0,0,0,0,0,0,0,0,1,0;
0,0,1,0,0,0,0,1,0,0,0,0,1;
0,0,0,1,0,0,0,0,1,0,0,1,0;
0,0,1,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,1,0,0,0,0,0,0,0,0;
0,0,0,0,1,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,1,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,1;
];
M0 = [0;0;0;0;0;0;0;0;0;0;2;2;1;1;6;6;6];
Te1 = [3 8 12];
Te2 = [1 2 3 4 5 6 7 8 9 10 11 12 13];
% w=[0;0;0;0;0;0;0;0;1;0;0;0;0;1;0;0;0];
% k=4;
% Te=[1 2 3 4 5 6 7 8 9 10 11 12 13];

% % %%%%%%%%%%Liu Gaiyun Paper Example (Ordinary version P=17, T=13) with
% % fake explicit transition t1******************************************
% Pre = [
% 0,0,1,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,1,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,1,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,1,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,1,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,1,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,1,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,1,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,1,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,1;
% 0,0,1,0,0,0,0,1,0,0,0,0,1,0;
% 0,0,0,1,0,0,0,0,1,0,0,1,0,0;
% 0,1,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,1,0,0,0,0,0,0,0,0,0,0;
% 0,1,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,1,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,1,0,0;
% ];
% Post = [
% 0,1,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,1,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,1,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,1,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,1,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,1,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,1,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,1,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,1,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,1,0;
% 0,0,0,1,0,0,0,0,1,0,0,0,0,1;
% 0,0,0,0,1,0,0,0,0,1,0,0,1,0;
% 0,0,0,1,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,1,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,1,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,1,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,1;
% ];
% M0 = [0;0;0;0;0;0;0;0;0;0;2;2;1;1;6;6;6];
% Te=[1 4 9 13];

% % %%%%%%%%Ma Ziyue Paper Example (Fig. 6)
% Post=[0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0;2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;0 1 0 0 0 0 0 2 0 0 0 0 0 0 0 0;0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0;0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0;0 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0;0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0;0 0 0 1 2 0 0 0 0 0 0 0 0 0 0 0;0 0 1 0 0 1 0 0 0 0 0 0 0 0 0 0;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3;0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0;0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0;0 0 0 0 0 0 0 0 0 0 0 5 0 0 0 0;0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0;0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0;0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0;0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0;0 0 0 0 0 0 0 0 0 0 0 2 0 1 0 0;0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0;0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0;0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0;0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0];
% Pre=[1 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0;0 1 0 0 0 0 0 0 2 0 0 0 0 0 0 0;0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0;0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0;0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0;0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0;0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0;0 1 1 0 0 0 0 2 0 0 0 0 0 0 0 0;0 1 0 0 1 0 0 0 1 0 0 0 0 0 0 0;0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0;0 0 0 0 0 0 0 0 0 0 3 0 0 0 0 0;0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0;0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0;0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0;0 0 0 0 0 0 0 0 0 0 0 0 0 0 5 0;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1;0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0;0 0 0 0 0 0 0 0 0 3 0 0 0 0 5 0;0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0;0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0;0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0;0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0];
% M0=[6 0 0 0 0 0 0 8 8 6 0 0 0 0 0 0 8 6 8 8 8 8]';
% % M0=[6 0 0 0 0 0 0 5 5 6 0 0 0 0 0 0 5 6 5 5 5 5]';
% Te=[3 6 11 13];
% nu=12;
% w=[0;1;0;0;0;0;0;0;1;0;0;0;0;1;0;0;0;0;0;0;0;0];
% k=1;
% Te=[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16];
% nu=0;


% %%%%%%%%Ma Ziyue Paper Example with fake explicit trnaistion t1 (Fig. 6)
% Post=[0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0;0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;0 0 1 0 0 0 0 0 2 0 0 0 0 0 0 0 0;0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0;0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0;0 0 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0;0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0;0 0 0 0 1 2 0 0 0 0 0 0 0 0 0 0 0;0 0 0 1 0 0 1 0 0 0 0 0 0 0 0 0 0;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3;0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0;0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0;0 0 0 0 0 0 0 0 0 0 0 0 5 0 0 0 0;0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0;0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0;0 0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0;0 0 0 0 0 0 0 0 0 0 0 0 2 0 1 0 0;0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0;0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0;0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0;0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0];
% Pre=[0 1 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0;
%     0 0 1 0 0 0 0 0 0 2 0 0 0 0 0 0 0;
%     0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0;
%     0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0;
%     0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0;
%     0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0;
%     0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0;
%     0 0 1 1 0 0 0 0 2 0 0 0 0 0 0 0 0;
%     0 0 1 0 0 1 0 0 0 1 0 0 0 0 0 0 0;
%     0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0;
%     0 0 0 0 0 0 0 0 0 0 0 3 0 0 0 0 0;
%     0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0;
%     0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0;
%     0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0;
%     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 5 0;
%     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1;
%     0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0;
%     0 0 0 0 0 0 0 0 0 0 3 0 0 0 0 5 0;
%     0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
%     0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0;
%     0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0;
%     0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0];
% % M0=[12 0 0 0 0 0 0 2 3 12 0 0 0 0 0 0 7 15 3 3 4 4]';
% M0=[6 0 0 0 0 0 0 2 2 6 0 0 0 0 0 0 2 6 2 2 2 2]';
% Te=[1 4 7 12 14];
% nu=12;

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Toni PPT 11.2 pp-9 Example
% % Post=[0 0 0 0 1;2 0 0 0 0;0 0 1 0 0;0 1 0 1 0];
% % Pre=[1 0 1 0 0;0 2 0 0 0;0 0 0 1 0;0 0 0 0 1];
% % M0=[0 2 1 0]';
% % Te=[1 3];
% 

%[Mw]=Mbasis(Pre , Post , M0, nu , w, TI )
% w=[0 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0]';
% kk=4;
% [B] =miny(Pre,Post,M,t,nu)
%[B] =ally(Pre,Post,M,t,nu

% M=[0;2;1];
% t=1;
% [B] =onlymax(Pre,Post,M,t,nu);
%*****************************
%******MCC 2017 Model*********
% Pre = [
% 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0;
% 0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0;
% 0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;
% 0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1;
% 0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0;
% 0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0;
% ];
% Post = [
% 0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0;
% 0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0;
% 0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;
% 0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1;
% 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;
% 0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0;
% ];
% M0 = [8;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;3;4;2];
% Te=[2 7 10 15 16];
%Te=[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18];
% nu=13;



tic;
[MMBRG]=MinimaxBRG(Pre,Post,M0,Te1);
toc;

tic;
[RG]=BRG(Pre,Post,M0,Te2);
toc;

%showBRG(B);
% tic;
% [MA] = Mall(Pre, Post,Te, B);
% [TestDeadlock] = TestDeadlock(MA,Pre);
% toc;
% % % tic;
% [MA_TE]=Mall_TE(Pre, Post, Te, B);
% toc;
% [MAD]=TestDeadlock(MA,Pre);
% [ICC] = ILPP_Checking_Code(Pre, Post, Te, MAD, B)
% % [MEfinal] = Testnonfinal(MA,w,k);

% % [SolRG]= SolveforRG(Pre, Post, M0, Te, B, w, k);
% tic;
%[Sol]= Solve(Pre, Post, M0, Te, B, w, k);
% toc;
% %******************************

